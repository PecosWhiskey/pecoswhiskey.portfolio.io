import{a as dt}from"./chunk-EK7H3RCW.js";import{a as lt}from"./chunk-VE47TFEJ.js";import"./chunk-UWBXMDG3.js";import{a as st,z as gt}from"./chunk-YR3PR77C.js";import{$ as rt,F as H,G,H as J,I as K,J as Q,L as X,M as Z,N as tt,O as et,P as it,V as ot,W as nt,_ as at,a as V,c as q,p as F,q as T,r as W,s as N,t as L,u as U,v as j,w as Y,z as $}from"./chunk-FQZTEKBF.js";import{Ea as I,Ia as B,Qa as E,Sa as S,Ta as M,Ua as y,Va as O,Wa as o,Xa as n,Ya as z,Z as h,_ as u,ab as A,bb as k,cb as p,jb as D,kb as s,lb as R,mb as d,ob as _,pb as v,qb as b,ua as r,za as P}from"./chunk-XN4KXQ72.js";import"./chunk-7GZTLLYP.js";import"./chunk-7KGURMOZ.js";import"./chunk-GZFC7DSC.js";import"./chunk-VAGHEIDN.js";import"./chunk-MRRG4YUJ.js";import"./chunk-W2DKFL3W.js";import"./chunk-GFAQE7C7.js";import"./chunk-4U6PRYVA.js";import"./chunk-OAACOBQM.js";import"./chunk-JWIEPCRG.js";import"./chunk-C5RQ2IC2.js";import"./chunk-D4VGNZLR.js";import"./chunk-JHLW7V75.js";import"./chunk-SV7S5NYR.js";import"./chunk-RW4GY4BD.js";function ct(g,c){if(g&1&&(o(0,"div",12),z(1,"ion-icon",13),o(2,"span"),s(3),n()()),g&2){let i=p(2);r(3),R(i.richiestaEsito)}}function pt(g,c){if(g&1){let i=A();o(0,"h1"),s(1),n(),o(2,"form",null,0)(4,"ion-item")(5,"ion-input",4),b("ngModelChange",function(e){let t=h(i).$index,l=p();return v(l.passeggeri[t].idPasseggero,e)||(l.passeggeri[t].idPasseggero=e),u(e)}),n()(),o(6,"ion-item")(7,"ion-input",5),b("ngModelChange",function(e){let t=h(i).$index,l=p();return v(l.passeggeri[t].nome,e)||(l.passeggeri[t].nome=e),u(e)}),n()(),o(8,"ion-item")(9,"ion-input",6),b("ngModelChange",function(e){let t=h(i).$index,l=p();return v(l.passeggeri[t].cognome,e)||(l.passeggeri[t].cognome=e),u(e)}),n()(),o(10,"ion-item",7)(11,"ion-label",8),s(12,"Data di nascita"),n(),o(13,"ion-input",9),b("ngModelChange",function(e){let t=h(i).$index,l=p();return v(l.passeggeri[t].dataNascita,e)||(l.passeggeri[t].dataNascita=e),u(e)}),n()(),o(14,"ion-item")(15,"ion-input",10),b("ngModelChange",function(e){let t=h(i).$index,l=p();return v(l.passeggeri[t].documentoID,e)||(l.passeggeri[t].documentoID=e),u(e)}),n()(),o(16,"ion-button",11),k("click",function(){let e=h(i).$index,t=p();return u(t.Acquista(t.passeggeri[e]))}),s(17,"Conferma"),n(),B(18,ct,4,1,"div",12),n()}if(g&2){let i=c.$index,a=D(3),e=p();r(),d("Inserire i dati del passeggero ",i+1,""),r(4),_("ngModel",e.passeggeri[i].idPasseggero),r(2),_("ngModel",e.passeggeri[i].nome),r(2),_("ngModel",e.passeggeri[i].cognome),r(4),_("ngModel",e.passeggeri[i].dataNascita),r(2),_("ngModel",e.passeggeri[i].documentoID),r(),E("disabled",!a.valid),r(2),S(e.richiestaEsito!=""?18:-1)}}function mt(g,c){if(g&1&&(o(0,"ion-card",14)(1,"ion-card-header")(2,"ion-card-title"),s(3),n()(),o(4,"ion-card-content")(5,"p"),s(6),n(),o(7,"p"),s(8),n(),o(9,"p"),s(10),n(),o(11,"p"),s(12),n(),o(13,"p"),s(14),n(),o(15,"p"),s(16),n()()()),g&2){let i=c.$implicit;r(3),d("CODICE: ",i.idBiglietto," "),r(3),d("Data: ",i.dataPartenza.split(" ")[0].split("-").reverse().join("-"),""),r(2),d("Partenza: ",i.dataPartenza.split(" ")[1],""),r(2),d("Arrivo: ",i.dataPartenza.split(" ")[2],""),r(2),d("CF: ",i.idPasseggero,""),r(2),d("Prezzo complessivo: ",i.prezzoFinale," \u20AC"),r(2),d("Data di acquisto: ",i.dataAcquisto,"")}}function ht(g,c){if(g&1&&(o(0,"h1"),s(1,"Dati riepilogativi dei biglietti"),n(),o(2,"h3"),s(3,"Ti ricordiamo di salvare il codice del tuo biglietto per effettuare il check-in!"),n(),y(4,mt,17,7,"ion-card",14,M)),g&2){let i=p();r(4),O(i.bigliettiCreati)}}function ut(g,c){if(g&1&&(o(0,"ion-card",14)(1,"ion-card-header")(2,"ion-card-title"),s(3),n()(),o(4,"ion-card-content")(5,"p"),s(6),n(),o(7,"p"),s(8),n(),o(9,"p"),s(10),n(),o(11,"p"),s(12),n(),o(13,"p"),s(14),n(),o(15,"p"),s(16),n()()()),g&2){let i=c.$implicit;r(3),d("CODICE: ",i.idBiglietto," "),r(3),d("Data: ",i.dataPartenza.split(" ")[0].split("-").reverse().join("-"),""),r(2),d("Partenza: ",i.dataPartenza.split(" ")[1],""),r(2),d("Arrivo: ",i.dataPartenza.split(" ")[2],""),r(2),d("CF: ",i.idPasseggero,""),r(2),d("Prezzo complessivo: ",i.prezzoFinale," \u20AC"),r(2),d("Data di acquisto: ",i.dataAcquisto.split("-").reverse().join("-"),"")}}function Ct(g,c){if(g&1&&(o(0,"h1"),s(1,"Dati riepilogativi dei biglietti"),n(),o(2,"h3"),s(3,"Ti ricordiamo di salvare il codice del tuo biglietto per effettuare il check-in!"),n(),y(4,ut,17,7,"ion-card",14,M)),g&2){let i=p();r(4),O(i.bigliettiCreati)}}var Bt=(()=>{let c=class c{constructor(a,e,t){this.location=a,this.sessionStorage=e,this.bigliettiService=t,this.idVolo="",this.idPasseggero="",this.nome="",this.cognome="",this.dataNascita="",this.documentoID="",this.tariffa="",this.posto="",this.dataPartenza="",this.prezzoFinale=0,this.dataAcquisto="",this.richiestaEsito="",this.bigliettoCreato=!1,this.modificaEsito="",this.passeggeroCreato=!1,this.numBigliettiCreatiAndata=0,this.numBigliettiCreatiRitorno=0,this.numPasseggeri=0,this.numeroPasseggeri=[],this.passeggeri=[],this.bigliettoAndata={idVolo:"",partenza:"",destinazione:"",oraPartenza:"",oraArrivo:"",prezzo:0,postiDisponibili:0},this.bigliettoRitorno={idVolo:"",partenza:"",destinazione:"",oraPartenza:"",oraArrivo:"",prezzo:0,postiDisponibili:0},this.sceltaUtente="",this.bigliettiCreati=[],st({informationCircleOutline:gt})}ngOnInit(){this.bigliettiService.getBigliettoAndata().subscribe(t=>{this.valutaBiglietto(t)&&(this.bigliettoAndata=t)}),this.bigliettiService.getBigliettoRitorno().subscribe(t=>{this.valutaBiglietto(t)&&(this.bigliettoRitorno=t)});let a=this.sessionStorage.getItem("numero passeggeri");a!=0&&(this.numPasseggeri=a,console.log("Numero di passeggeri: ",this.numPasseggeri),this.numeroPasseggeri=Array.from({length:a},(t,l)=>l+1),this.inizializzaPasseggeri());let e=this.sessionStorage.getItem("sceltaUtente");e!=null&&(this.sceltaUtente=e),this.bigliettiService.getnumBigliettiCreatiAndata().subscribe(t=>{this.numBigliettiCreatiAndata=t}),this.bigliettiService.getnumBigliettiCreatiRitorno().subscribe(t=>{this.numBigliettiCreatiRitorno=t}),console.log("Biglietto andata: ",this.bigliettoAndata),console.log("Biglietto ritorno: ",this.bigliettoRitorno)}ionViewWillLeave(){this.bigliettiService.resetBigliettiCreati()}valutaBiglietto(a){return a.idVolo!=""&&a.partenza!=""&&a.destinazione!=""&&a.oraPartenza!=""&&a.oraArrivo!=""&&a.prezzo!=0&&a.postiDisponibili!=0}inizializzaPasseggeri(){this.passeggeri=[];for(let a=0;a<this.numPasseggeri;a++)this.passeggeri.push({idPasseggero:"",nome:"",cognome:"",dataNascita:"",documentoID:""})}Acquista(a){console.log(a),this.bigliettiService.CreaPasseggero(a).subscribe({next:e=>{console.log("Creation success:",e),this.passeggeroCreato=!0,this.idPasseggero=e.data.idPasseggero;let t=new Date;console.log("Data corrente: ",t),console.log("data in formato iso: ",t.toISOString()),this.dataAcquisto=t.toISOString().split("T")[0];let l={idVolo:this.bigliettoAndata.idVolo,idPasseggero:this.idPasseggero,tariffa:this.tariffa,posto:this.posto,dataPartenza:this.bigliettoAndata.oraPartenza+" "+this.bigliettoAndata.oraArrivo.split(" ")[1],prezzoFinale:this.bigliettoAndata.prezzo,dataAcquisto:this.dataAcquisto};if(console.log("id volo biglietto andata: ",this.bigliettoAndata),console.log("ID VOLO: ",l.idVolo),this.bigliettiService.CreaBiglietto(l).subscribe({next:C=>{console.log("Creation success:",C),this.numBigliettiCreatiAndata++,this.bigliettiService.setnumBigliettiCreatiAndata(this.numBigliettiCreatiAndata),console.log("Biglietti creati andata: ",this.bigliettiService.getnumBigliettiCreatiAndata()),this.bigliettiCreati.push(C.data),console.log(this.bigliettiCreati),this.bigliettoCreato=!0;let m=this.bigliettoAndata.postiDisponibili-this.numBigliettiCreatiAndata,w={idVolo:this.bigliettoAndata.idVolo,posti:m};this.bigliettiService.ModificaVolo(w).subscribe({next:x=>{console.log("Modification success:",x)},error:x=>{console.log("Modification error:",x),this.richiestaEsito=x.error.message}})},error:C=>{console.log("Creation error:",C),this.richiestaEsito=="Biglietto per questo passeggero e per questo volo gi\xE0 acquistato!"?this.richiestaEsito="Biglietto di andata per questo passeggero e per questo volo gi\xE0 acquistato!":this.richiestaEsito="ERRORE: Dati per il biglietto di andata non validi!"}}),this.valutaBiglietto(this.bigliettoRitorno)){let C={idVolo:this.bigliettoRitorno.idVolo,idPasseggero:this.idPasseggero,tariffa:this.tariffa,posto:this.posto,dataPartenza:this.bigliettoRitorno.oraPartenza+" "+this.bigliettoRitorno.oraArrivo.split(" ")[1],prezzoFinale:this.bigliettoRitorno.prezzo,dataAcquisto:this.dataAcquisto};this.bigliettiService.CreaBiglietto(C).subscribe({next:m=>{console.log("Creation success:",m),this.numBigliettiCreatiRitorno++,this.bigliettiService.setnumBigliettiCreatiRitorno(this.numBigliettiCreatiRitorno),console.log("biglietti creati ritorno: ",this.bigliettiService.getnumBigliettiCreatiRitorno()),this.bigliettiCreati.push(m.data),this.bigliettoCreato=!0;let w=this.bigliettoRitorno.postiDisponibili-this.numBigliettiCreatiRitorno,x={idVolo:this.bigliettoRitorno.idVolo,posti:w};this.bigliettiService.ModificaVolo(x).subscribe({next:f=>{console.log("Modification success:",f),this.modificaEsito=f.message},error:f=>{console.log("Modification error:",f),this.modificaEsito=f.error.message}})},error:m=>{console.log("Creation error:",m),this.richiestaEsito=m.error.message,this.richiestaEsito=="Biglietto per questo passeggero e per questo volo gi\xE0 acquistato!"?this.richiestaEsito="Biglietto di ritorno per questo passeggero e per questo volo gi\xE0 acquistato!":this.richiestaEsito="ERRORE: Dati per il biglietto di ritorno non validi!"}})}},error:e=>{console.log("Creation error:",e),this.richiestaEsito="ERRORE: Dati del passeggero non validi!",this.passeggeroCreato=!1}})}goBack(){this.location.back()}};c.\u0275fac=function(e){return new(e||c)(P(V),P(lt),P(dt))},c.\u0275cmp=I({type:c,selectors:[["app-crea-biglietto"]],decls:11,vars:1,consts:[["userForm","ngForm"],[1,"custom-header"],["slot","start"],["defaultHref","/tabs/tab1","text","Indietro"],["type","text","name","idPasseggero","placeholder","Codice fiscale del passeggero","ngDefaultControl","","required","",3,"ngModelChange","ngModel"],["type","text","name","nome","placeholder","Nome del passeggero","ngDefaultControl","","required","",3,"ngModelChange","ngModel"],["type","text","name","cognome","placeholder","Cognome del passeggero","ngDefaultControl","","required","",3,"ngModelChange","ngModel"],["lines","full"],["position","stacked"],["type","date","name","data","required","","ngDefaultControl","",3,"ngModelChange","ngModel"],["type","text","name","documentoID","placeholder","Documento","ngDefaultControl","","required","",3,"ngModelChange","ngModel"],[3,"click","disabled"],[1,"feedback-info"],["name","information-circle-outline"],[1,"results-card"]],template:function(e,t){e&1&&(o(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),z(3,"ion-back-button",3),n(),o(4,"ion-title"),s(5,"Crea Biglietto"),n()()(),o(6,"ion-content"),y(7,pt,19,8,null,null,M),B(9,ht,6,0)(10,Ct,6,0),n()),e&2&&(r(7),O(t.numeroPasseggeri),r(2),S(t.valutaBiglietto(t.bigliettoAndata)&&t.valutaBiglietto(t.bigliettoRitorno)&&t.numBigliettiCreatiAndata==t.numPasseggeri&&t.numBigliettiCreatiRitorno==t.numPasseggeri?9:t.valutaBiglietto(t.bigliettoAndata)&&t.numBigliettiCreatiAndata==t.numPasseggeri?10:-1))},dependencies:[q,Y,U,F,T,W,j,L,N,Z,tt,ot,nt,G,$,H,et,rt,it,J,Q,X,K,at],styles:['ion-content[_ngcontent-%COMP%]{--padding-start: 20px;--padding-end: 20px;--padding-top: 24px;--background: var(--vaygo-background);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;color:var(--vaygo-text-primary)}form[_ngcontent-%COMP%]{background:var(--vaygo-white);border-radius:16px;padding:24px;margin-bottom:20px;box-shadow:0 8px 32px var(--vaygo-shadow-medium);border:1px solid var(--vaygo-border)}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{margin-bottom:16px;border-radius:12px;--background: var(--vaygo-white);--border-color: var(--vaygo-border);--border-width: 1px;--border-style: solid;--color: var(--vaygo-text-primary);box-shadow:0 2px 8px var(--vaygo-shadow);transition:all .3s ease}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:hover{--background: var(--vaygo-background);box-shadow:0 4px 16px var(--vaygo-shadow-medium);transform:translateY(-2px)}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:focus-within{--border-color: var(--vaygo-secondary);--border-width: 2px;box-shadow:0 0 0 3px #4a90e226}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--color: var(--vaygo-text-primary);--placeholder-color: var(--vaygo-text-secondary);font-size:16px;font-weight:400;transition:color .2s ease}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]:focus{--color: var(--vaygo-primary)}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:600;color:var(--vaygo-primary);font-size:14px;text-transform:uppercase;letter-spacing:.5px}form[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-top:32px;margin-bottom:20px;width:100%;height:56px;font-size:18px;font-weight:700;text-transform:uppercase;letter-spacing:1px;--border-radius: 16px;--background: linear-gradient(135deg, var(--vaygo-primary), var(--vaygo-secondary));--color: var(--vaygo-white);--box-shadow: 0 8px 24px rgba(46, 139, 87, .3);transition:all .3s ease}form[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:hover{transform:translateY(-3px);--box-shadow: 0 12px 32px rgba(46, 139, 87, .4)}form[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:active{transform:translateY(-1px);--box-shadow: 0 4px 16px rgba(46, 139, 87, .3)}form[_ngcontent-%COMP%]   ion-button[disabled][_ngcontent-%COMP%]{--background: var(--vaygo-text-secondary);--color: var(--vaygo-white);opacity:.6;transform:none;--box-shadow: none}h1[_ngcontent-%COMP%]{color:var(--vaygo-primary);font-weight:700;margin:24px 0 16px;font-size:28px;text-align:center;letter-spacing:-.5px}h3[_ngcontent-%COMP%]{color:var(--vaygo-text-secondary);font-weight:600;margin:16px 0;text-align:center;line-height:1.5}.results-card[_ngcontent-%COMP%]{--background: var(--vaygo-white);border-radius:16px;box-shadow:0 4px 20px var(--vaygo-shadow);border:1px solid var(--vaygo-border);margin-bottom:24px;transition:all .3s ease}.results-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 32px var(--vaygo-shadow-medium)}.results-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--vaygo-primary),var(--vaygo-secondary));padding:20px 24px 16px}.results-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:var(--vaygo-white);margin:0;text-align:center;letter-spacing:.5px}.results-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:24px;color:var(--vaygo-text-primary)}.results-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;font-size:16px;line-height:1.5;color:var(--vaygo-text-secondary)}.results-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-of-type{font-size:20px;font-weight:700;color:var(--vaygo-primary);margin:16px 0 0;text-align:center}ion-input[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--padding-top: 12px;--padding-bottom: 12px;--color: var(--vaygo-text-primary)}ion-input[type=date][_ngcontent-%COMP%]{--padding-top: 14px}ion-item[lines=full][_ngcontent-%COMP%]{background:var(--vaygo-background);border-radius:12px}ion-item[lines=full][_ngcontent-%COMP%]   ion-label[position=stacked][_ngcontent-%COMP%]{margin-bottom:12px;font-size:13px;position:relative;color:var(--vaygo-primary)}ion-item[lines=full][_ngcontent-%COMP%]   ion-label[position=stacked][_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-4px;left:0;width:30px;height:2px;background:var(--vaygo-primary);border-radius:1px}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}form[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .8s ease-out}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .6s ease-out;animation-fill-mode:both}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(3){animation-delay:.3s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(4){animation-delay:.4s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(5){animation-delay:.5s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(6){animation-delay:.6s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(7){animation-delay:.7s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(8){animation-delay:.8s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(9){animation-delay:.9s}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:nth-child(10){animation-delay:1s}@media (max-width: 768px){ion-content[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px}form[_ngcontent-%COMP%]{padding:20px;margin:10px 0}h1[_ngcontent-%COMP%]{font-size:24px}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}.custom-header[_ngcontent-%COMP%]{--background: var(--vaygo-white);box-shadow:0 2px 8px var(--vaygo-shadow);border-bottom:1px solid var(--vaygo-border);--opacity: 1}.custom-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: var(--vaygo-white);--color: var(--vaygo-text-primary);--padding-start: 16px;--padding-end: 16px;--min-height: 56px}.custom-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:var(--vaygo-primary);text-align:center}.custom-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]{--color: var(--vaygo-primary);--icon-font-size: 20px;font-weight:600;--padding-start: 0;--padding-end: 8px}.custom-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]::part(text){margin-left:8px;font-size:16px}.custom-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]::part(icon){font-size:20px}']});let g=c;return g})();export{Bt as CreaBigliettoPage};
