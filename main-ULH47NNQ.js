import{a as u}from"./chunk-FVW34XAK.js";import{D as E,Y as S,d as C,f as k,g as A,h as z,i as m,l as b,m as R,n as P,x as I,y as T}from"./chunk-FQZTEKBF.js";import{Ea as g,T as a,Wa as f,Xa as h,Ya as v,l,x as p}from"./chunk-XN4KXQ72.js";import"./chunk-7GZTLLYP.js";import"./chunk-7KGURMOZ.js";import"./chunk-GZFC7DSC.js";import"./chunk-VAGHEIDN.js";import"./chunk-MRRG4YUJ.js";import"./chunk-W2DKFL3W.js";import"./chunk-GFAQE7C7.js";import"./chunk-4U6PRYVA.js";import"./chunk-OAACOBQM.js";import"./chunk-JWIEPCRG.js";import"./chunk-C5RQ2IC2.js";import"./chunk-D4VGNZLR.js";import"./chunk-JHLW7V75.js";import"./chunk-SV7S5NYR.js";import"./chunk-RW4GY4BD.js";var w=(o,e)=>{let r=a(u),n=a(m);if(o.url.includes("/login-admin")||o.url.includes("/registrazione-cliente")||o.url.includes("/login-cliente"))return console.log("Richiesta di registrazione o login..."),e(o).pipe(p(i=>(console.log("Errore nella richiesta di registrazione o login:",i),l(()=>i))));let t=r.getToken(),d=r.isTokenExpired();if(t){if(d)return console.log("Token scaduto! Reindirizzamento al login..."),y(r,n),l(()=>new Error("Token scaduto"));{console.log("Effettuando la richiesta con token...");let i=o;return i=o.clone({setHeaders:{Authorization:`Bearer ${t}`}}),e(i).pipe(p(c=>((c.status===401||c.status===403)&&(console.log("Token non valido! Reindirizzamento al login..."),y(r,n)),console.log("Errore nella richiesta http",c),l(()=>c))))}}else return console.log("Effettuando la richiesta senza token..."),e(o).pipe(p(i=>(console.log("Errore nella richiesta http",i),l(()=>i))))};function y(o,e){o.logout(),e.navigate(["/tabs/tab3"])}var s=(o,e)=>{let r=a(u),n=a(m);try{return r.isLogged()?(console.log("Accesso consentito"),!0):(console.log("Accesso negato"),n.navigate(["/tabs/tab3"]),!1)}catch(t){return console.error("Errore controllo autenticazione:",t),n.navigate(["/tabs/tab3"]),!1}};var x=[{path:"",loadChildren:()=>import("./chunk-56BWGT47.js").then(o=>o.routes)},{path:"home",loadComponent:()=>import("./chunk-HZ4RFVBT.js").then(o=>o.HomePage),canActivate:[s]},{path:"gestione-voli",loadComponent:()=>import("./chunk-GQKK6NDW.js").then(o=>o.GestioneVoliPage),canActivate:[s]},{path:"crea-biglietto",loadComponent:()=>import("./chunk-QYWSECNI.js").then(o=>o.CreaBigliettoPage)},{path:"check-in",loadComponent:()=>import("./chunk-UWZ7GOTV.js").then(o=>o.CheckInPage)},{path:"prenotazioni",loadComponent:()=>import("./chunk-MVLL4FXK.js").then(o=>o.PrenotazioniPage),canActivate:[s]},{path:"biglietti-acquistati",loadComponent:()=>import("./chunk-F2DXT4XJ.js").then(o=>o.BigliettiAcquistatiPage),canActivate:[s]},{path:"voli-disponibili",loadComponent:()=>import("./chunk-FYTK2FDM.js").then(o=>o.VoliDisponibiliPage)}];var B=(()=>{let e=class e{constructor(){}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=g({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(t,d){t&1&&(f(0,"ion-app"),v(1,"ion-router-outlet"),h())},dependencies:[E,T],encapsulation:2});let o=e;return o})();C(B,{providers:[{provide:z,useClass:I},S(),R(x,P(b)),k(A([w]))]});
